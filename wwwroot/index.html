<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PDU CID</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="tablet-frame">
        <div class="tablet-bezel">

            <div class="main-layout">
                <!-- 왼쪽: 회로 흐름도 SVG -->
                <div class="diagram-area">
                    <svg id="flow-svg" viewBox="0 0 1100 680" xmlns="http://www.w3.org/2000/svg">

                        <defs>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="blur" />
                                <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
                            </filter>
                        </defs>

                        <line class="wire-return" x1="555" y1="555" x2="555" y2="610" />
                        <line class="wire-return" x1="725" y1="555" x2="725" y2="610" />
                        <line class="wire-return" x1="895" y1="480" x2="895" y2="610" />

                        <g id="path-series" class="wire-group off">
                            <polyline class="wire wire-pos" points="200,145 300,145" />
                            <polyline class="wire wire-pos" points="360,145 440,145 440,250" />
                            <polyline class="flow flow-pos" points="200,145 300,145" />
                            <polyline class="flow flow-pos" points="360,145 440,145 440,250" />
                        </g>

                        <g id="path-parallel" class="wire-group off">
                            <polyline class="wire wire-pos" points="200,375 300,375" />
                            <polyline class="wire wire-pos" points="360,375 440,375 440,260" />
                            <polyline class="flow flow-pos" points="200,375 300,375" />
                            <polyline class="flow flow-pos" points="360,375 440,375 440,260" />
                        </g>

                        <g id="path-dc-pos" class="wire-group off">
                            <polyline class="wire wire-pos" points="600,250 600,70" />
                            <polyline class="wire wire-pos" points="614,70 700,70" />
                            <polyline class="wire wire-pos" points="760,70 880,70" />
                            <polyline class="flow flow-pos" points="600,250 600,70" />
                            <polyline class="flow flow-pos" points="614,70 700,70" />
                            <polyline class="flow flow-pos" points="760,70 880,70" />
                        </g>

                        <g id="path-obc" class="wire-group off">
                            <polyline class="wire wire-pos" points="555,260 555,270" />
                            <polyline class="wire wire-pos" points="555,330 555,410" />
                            <polyline class="flow flow-pos" points="555,260 555,270" />
                            <polyline class="flow flow-pos" points="555,330 555,410" />
                        </g>

                        <g id="path-obc-ac" class="wire-group off">
                            <line class="wire wire-pos" x1="555" y1="480" x2="555" y2="505" />
                            <line class="flow flow-pos" x1="555" y1="480" x2="555" y2="505" />
                        </g>

                        <g id="path-inv" class="wire-group off">
                            <polyline class="wire wire-pos" points="725,260 725,270" />
                            <polyline class="wire wire-pos" points="725,330 725,410" />
                            <polyline class="flow flow-pos" points="725,260 725,270" />
                            <polyline class="flow flow-pos" points="725,330 725,410" />
                        </g>

                        <g id="path-inv-load" class="wire-group off">
                            <line class="wire wire-pos" x1="725" y1="480" x2="725" y2="505" />
                            <line class="flow flow-pos" x1="725" y1="480" x2="725" y2="505" />
                        </g>

                        <g id="path-ldc" class="wire-group off">
                            <polyline class="wire wire-pos" points="895,260 895,270" />
                            <polyline class="wire wire-pos" points="895,330 895,410" />
                            <polyline class="flow flow-pos" points="895,260 895,270" />
                            <polyline class="flow flow-pos" points="895,330 895,410" />
                        </g>

                        <g id="path-b1n" class="wire-group off">
                            <polyline class="wire wire-neg" points="180,175 230,175 230,610" />
                            <polyline class="flow flow-neg" points="180,175 230,175 230,610" />
                        </g>

                        <g id="path-b2n" class="wire-group off">
                            <polyline class="wire wire-neg" points="180,405 270,405 270,610" />
                            <polyline class="flow flow-neg" points="180,405 270,405 270,610" />
                        </g>

                        <g id="path-dc-neg" class="wire-group off">
                            <polyline class="wire wire-neg" points="860,615 860,615" />
                            <polyline class="wire wire-neg" points="920,615 960,615 960,105" />
                            <polyline class="flow flow-neg" points="920,615 960,615 960,105" />
                        </g>

                        <rect id="bus-pos" class="bus-bar bus-pos-bar" x="440" y="249" width="530" height="12" rx="4" />
                        <text class="bus-label" x="705" y="245">P+ BUS</text>

                        <rect id="bus-neg" class="bus-bar bus-neg-bar" x="220" y="609" width="750" height="12" rx="4" />
                        <text class="bus-label-neg" x="595" y="643">N- BUS</text>

                        <path class="comp-box" d="M48,100 H180 V124 H200 V164 H180 V190 H48 Z" />
                        <line class="batt-plate-long" x1="62" y1="118" x2="62" y2="172" />
                        <line class="batt-plate-short" x1="72" y1="130" x2="72" y2="160" />
                        <text class="comp-label" x="130" y="128">Battery 1</text>
                        <text id="txt-b1v" class="comp-value" x="130" y="155">0 V</text>
                        <text id="txt-b1a" class="comp-value-sub" x="130" y="178">0 A</text>

                        <path class="comp-box" d="M48,330 H180 V354 H200 V394 H180 V420 H48 Z" />
                        <line class="batt-plate-long" x1="62" y1="348" x2="62" y2="402" />
                        <line class="batt-plate-short" x1="72" y1="360" x2="72" y2="390" />
                        <text class="comp-label" x="130" y="358">Battery 2</text>
                        <text id="txt-b2v" class="comp-value" x="130" y="385">0 V</text>
                        <text id="txt-b2a" class="comp-value-sub" x="130" y="408">0 A</text>

                        <rect id="svg-mode-bg" class="mode-badge-bg" x="50" y="230" width="140" height="30" rx="6" />
                        <text id="svg-mode" class="mode-badge-text" x="120" y="250">대기</text>

                        <rect class="total-badge-bg" x="460" y="225" width="120" height="24" rx="5" />
                        <text class="total-label" x="483" y="241">Total</text>
                        <text id="txt-total" class="total-value" x="555" y="242">0 V</text>

                        <rect id="box-dc" class="comp-box" x="880" y="35" width="150" height="70" rx="8" />
                        <text class="comp-label" x="955" y="62">DC 급속충전</text>
                        <text class="comp-value-sub" x="955" y="82">커넥터</text>

                        <rect id="box-obc" class="comp-box" x="485" y="410" width="140" height="70" rx="8" />
                        <text class="comp-label" x="555" y="438">OBC</text>
                        <text id="txt-obc" class="comp-value-sub" x="555" y="462">0V / 0A</text>

                        <rect id="box-ac" class="comp-box comp-ac" x="485" y="505" width="140" height="50" rx="8" />
                        <text class="comp-label" x="555" y="528">AC Input</text>
                        <text id="txt-ac" class="comp-value-sub" x="555" y="545">0 V</text>

                        <rect id="box-inv" class="comp-box" x="655" y="410" width="140" height="70" rx="8" />
                        <text class="comp-label" x="725" y="438">Inverter</text>
                        <text class="comp-value-sub" x="725" y="462">구동부</text>

                        <rect id="box-load" class="comp-box" x="655" y="505" width="140" height="50" rx="8" />
                        <text class="comp-label" x="725" y="528">Load</text>
                        <text class="comp-value-sub" x="725" y="545">부하</text>

                        <rect id="box-ldc" class="comp-box" x="825" y="410" width="140" height="70" rx="8" />
                        <text class="comp-label" x="895" y="438">LDC</text>
                        <text id="txt-ldc" class="comp-value-sub" x="895" y="462">0V / 0A</text>

                        <g id="rly-DC_P" class="relay off" transform="translate(700,59)">
                            <line class="relay-arm-closed" x1="0" y1="11" x2="60" y2="11" />
                            <line class="relay-arm-open" x1="15" y1="11" x2="45" y2="-3" />
                            <circle class="relay-terminal" cx="12" cy="11" r="3" />
                            <circle class="relay-terminal" cx="48" cy="11" r="3" />
                            <text class="relay-text" x="30" y="5">R1</text>
                        </g>
                        <text class="relay-name" x="730" y="54">DC_P</text>

                        <g id="rly-BAT_S" class="relay off" transform="translate(300,134)">
                            <line class="relay-arm-closed" x1="0" y1="11" x2="60" y2="11" />
                            <line class="relay-arm-open" x1="15" y1="11" x2="45" y2="-3" />
                            <circle class="relay-terminal" cx="12" cy="11" r="3" />
                            <circle class="relay-terminal" cx="48" cy="11" r="3" />
                            <text class="relay-text" x="30" y="5">R2</text>
                        </g>
                        <text class="relay-name" x="330" y="130">BAT_S</text>

                        <g id="rly-BAT_PPC" class="relay off" transform="translate(300,364)">
                            <line class="relay-arm-closed" x1="0" y1="11" x2="60" y2="11" />
                            <line class="relay-arm-open" x1="15" y1="11" x2="45" y2="-3" />
                            <circle class="relay-terminal" cx="12" cy="11" r="3" />
                            <circle class="relay-terminal" cx="48" cy="11" r="3" />
                            <text class="relay-text" x="30" y="5">R3</text>
                        </g>
                        <text class="relay-name" x="330" y="360">BAT_PPC</text>

                        <g id="rly-OBC" class="relay off" transform="translate(530,270)">
                            <line class="relay-arm-closed" x1="25" y1="0" x2="25" y2="60" />
                            <line class="relay-arm-open" x1="25" y1="15" x2="39" y2="45" />
                            <circle class="relay-terminal" cx="25" cy="12" r="3" />
                            <circle class="relay-terminal" cx="25" cy="48" r="3" />
                            <text class="relay-text" x="8" y="34">R4</text>
                        </g>
                        <text class="relay-name" x="555" y="266">OBC</text>

                        <g id="rly-INV" class="relay off" transform="translate(700,270)">
                            <line class="relay-arm-closed" x1="25" y1="0" x2="25" y2="60" />
                            <line class="relay-arm-open" x1="25" y1="15" x2="39" y2="45" />
                            <circle class="relay-terminal" cx="25" cy="12" r="3" />
                            <circle class="relay-terminal" cx="25" cy="48" r="3" />
                            <text class="relay-text" x="8" y="34">R5</text>
                        </g>
                        <text class="relay-name" x="725" y="266">INV</text>

                        <g id="rly-LDC" class="relay off" transform="translate(870,270)">
                            <line class="relay-arm-closed" x1="25" y1="0" x2="25" y2="60" />
                            <line class="relay-arm-open" x1="25" y1="15" x2="39" y2="45" />
                            <circle class="relay-terminal" cx="25" cy="12" r="3" />
                            <circle class="relay-terminal" cx="25" cy="48" r="3" />
                            <text class="relay-text" x="8" y="34">R6</text>
                        </g>
                        <text class="relay-name" x="895" y="266">LDC</text>

                        <g id="rly-DC_N" class="relay off" transform="translate(860,604)">
                            <line class="relay-arm-closed" x1="0" y1="11" x2="60" y2="11" />
                            <line class="relay-arm-open" x1="15" y1="11" x2="45" y2="-3" />
                            <circle class="relay-terminal" cx="12" cy="11" r="3" />
                            <circle class="relay-terminal" cx="48" cy="11" r="3" />
                            <text class="relay-text" x="30" y="5">R7</text>
                        </g>
                        <text class="relay-name" x="890" y="600">DC_N</text>

                        <g class="node-group">
                            <circle class="node-point" cx="600" cy="70" r="14" />
                            <text class="node-label" x="600" y="75">A</text>
                            <title>
                                A 포인트: DC 급속충전 분기점
                                P+ BUS에서 R1(DC_P) 릴레이를 거쳐
                                DC 급속충전 커넥터로 연결되는 지점
                            </title>
                        </g>

                        <g class="node-group">
                            <circle class="node-point" cx="440" cy="255" r="14" />
                            <text class="node-label" x="440" y="260">B</text>
                            <title>
                                B 포인트: 직렬/병렬 전환 분기점
                                Battery1(R2)과 Battery2(R3)의 전류가 합류하고
                                OBC(R4), Inverter(R5), LDC(R6)로 분배되는 중심 노드
                            </title>
                        </g>

                        <text class="terminal-pos" x="207" y="142">P+</text>
                        <text class="terminal-neg" x="187" y="180">N-</text>
                        <text class="terminal-pos" x="207" y="372">P+</text>
                        <text class="terminal-neg" x="187" y="410">N-</text>
                        <text class="terminal-pos" x="875" y="68">P+</text>
                        <text class="terminal-neg" x="955" y="110">N-</text>

                    </svg>
                </div>

                <!-- 오른쪽: 데이터 패널 -->
                <div class="data-panel">

                    <!-- 상단 상태 바 -->
                    <div class="panel-topbar">
                        <span class="panel-title">PDU CID</span>
                        <span id="conn-status" class="disconnected">연결 끊김</span>
                        <span id="timestamp"></span>
                    </div>

                    <div class="card card-mode">
                        <div id="mode-display" class="mode-box">대기</div>
                    </div>

                    <div class="card">
                        <h3>배터리</h3>
                        <div class="data-grid-2col">
                            <div class="data-cell">
                                <span class="data-label">Batt1 전압</span>
                                <span id="val-b1v" class="val">0 V</span>
                            </div>
                            <div class="data-cell">
                                <span class="data-label">Batt2 전압</span>
                                <span id="val-b2v" class="val">0 V</span>
                            </div>
                            <div class="data-cell">
                                <span class="data-label">Batt1 전류</span>
                                <span id="val-b1a" class="val">0 A</span>
                            </div>
                            <div class="data-cell">
                                <span class="data-label">Batt2 전류</span>
                                <span id="val-b2a" class="val">0 A</span>
                            </div>
                        </div>
                        <div class="data-row total-row">
                            <span>Total Voltage</span>
                            <span id="val-tv" class="val val-total">0 V</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>릴레이 상태</h3>
                        <div class="relay-section">
                            <div class="relay-section-label">직렬</div>
                            <div class="relay-row">
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_S"></span>BAT_S</div>
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_PC"></span>BAT_PC</div>
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_NC"></span>BAT_NC</div>
                            </div>
                        </div>
                        <div class="relay-section">
                            <div class="relay-section-label">병렬</div>
                            <div class="relay-row">
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_PPC"></span>BAT_PPC</div>
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_PNC"></span>BAT_PNC</div>
                                <div class="rly-item"><span class="rly-led off" id="led-BAT_PP"></span>BAT_PP</div>
                            </div>
                        </div>
                        <div class="relay-section">
                            <div class="relay-section-label">출력</div>
                            <div class="relay-row">
                                <div class="rly-item"><span class="rly-led off" id="led-DC_P"></span>DC_P</div>
                                <div class="rly-item"><span class="rly-led off" id="led-DC_N"></span>DC_N</div>
                                <div class="rly-item"><span class="rly-led off" id="led-OBC"></span>OBC</div>
                                <div class="rly-item"><span class="rly-led off" id="led-LDC"></span>LDC</div>
                                <div class="rly-item"><span class="rly-led off" id="led-INV"></span>INV</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>OBC (충전기)</h3>
                        <div class="data-row"><span>충전 전압</span><span id="val-obc-v" class="val">0 V</span></div>
                        <div class="data-row"><span>충전 전류</span><span id="val-obc-a" class="val">0 A</span></div>
                        <div class="data-row"><span>온도</span><span id="val-obc-t" class="val">0 &#8451;</span></div>
                        <div class="data-row"><span>AC R/S/T</span><span id="val-ac" class="val">0 / 0 / 0 V</span></div>
                    </div>

                    <div class="card">
                        <h3>LDC (DC-DC)</h3>
                        <div class="data-row"><span>출력 전압</span><span id="val-ldc-v" class="val">0 V</span></div>
                        <div class="data-row"><span>출력 전류</span><span id="val-ldc-a" class="val">0 A</span></div>
                        <div class="data-row"><span>온도</span><span id="val-ldc-t" class="val">0 &#8451;</span></div>
                        <div class="data-row"><span>동작</span><span id="val-ldc-work" class="val">OFF</span></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
